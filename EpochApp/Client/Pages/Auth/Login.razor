@page "/Auth/Login"
@using EpochApp.Shared
@using EpochApp.Client.Services
<PageTitle>Log-In</PageTitle>
<MudText Typo="Typo.h1">Login</MudText>

<EditForm Model="@_login" OnValidSubmit="async () => await AttemptLoginAsync()">
    <MudTextField Required="true" T="string" Label="Username" @bind-Value="@_login.UserName"  />
    <MudTextField Required="true" T="string" Label="Password" @bind-Value="@_login.Password" InputType="InputType.Password" />
    <MudButton ButtonType="ButtonType.Submit">Login</MudButton>
</EditForm>

@code {

    [Inject] public NavigationManager NavigationManager { get; set; }
    [Inject] public EpochAuthProvider _auth { get; set; }
    private LoginDTO _login = new LoginDTO();


    public async Task AttemptLoginAsync()
    {
        await _auth.LoginAsync(_login.UserName, _login.Password);
        if (_auth.CurrentUser != null)
        {
            NavigationManager.NavigateTo("/");
        }
    }
}